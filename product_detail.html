{% extends 'base.html' %}

{% block title %}{{ product['ìƒí’ˆëª…'] }} ìƒì„¸ ì •ë³´{% endblock %}

{% block content %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<div class="container my-5">
    <div class="row g-5">
        <!-- ì¢Œì¸¡: ìƒí’ˆ ìƒì„¸ ì„¤ëª… -->
        <div class="col-lg-8">
            <h1 class="fw-bold mb-4">{{ product['ìƒí’ˆëª…'] }}</h1>
            <p class="lead">ì€í–‰: <strong>{{ product['ê¸ˆìœµíšŒì‚¬ëª…'] }}</strong></p>

            {% if product_type == 'ëŒ€ì¶œ' %}
                <p class="lead">ìµœì € ê¸ˆë¦¬: <strong>{{ product['ê¸°ë³¸ê¸ˆë¦¬(%)'] }}</strong></p>
                <p class="lead">ëŒ€ì¶œ í•œë„: <strong>{{ product['ëŒ€ì¶œí•œë„'] }}</strong></p>
                <p class="lead">ìƒí™˜ ë°©ì‹: <strong>{{ product['ë§Œê¸°ì´ì'] }}</strong></p>
                <p class="lead">ê°€ì… ëŒ€ìƒ: <strong>{{ product['ê°€ì…ëŒ€ìƒ'] }}</strong></p>
                <p class="lead">ëŒ€ì¶œ ê¸°ê°„: <strong>{{ product['ì €ì¶•ê¸°ê°„(ê°œì›”)'] }}</strong></p>

                <hr class="my-4">

                <h4 class="fw-bold">ìš°ëŒ€ ì¡°ê±´</h4>
                <p>{{ product.get('ìš°ëŒ€ì¡°ê±´', 'ì •ë³´ ì—†ìŒ') }}</p>
            {% else %}
                <p class="lead">ìµœê³  ìš°ëŒ€ê¸ˆë¦¬: <strong>{{ product['ìµœê³ ìš°ëŒ€ê¸ˆë¦¬(%)'] }}%</strong></p>
                <p class="lead">ê°€ì… ê¸°ê°„: <strong>{{ product['ì €ì¶•ê¸°ê°„(ê°œì›”)'] }}ê°œì›”</strong></p>

                <hr class="my-4">

                <h4 class="fw-bold">ìš°ëŒ€ ì¡°ê±´</h4>
                <p>{{ product.get('ìš°ëŒ€ì¡°ê±´', 'ì •ë³´ ì—†ìŒ') }}</p>
            {% endif %}

            <div class="mt-5">
                <a href="/{{ product_type_url }}" class="btn btn-outline-dark me-2">â† ëª©ë¡ìœ¼ë¡œ</a>
                <a href="/" class="btn btn-outline-dark">ë©”ì¸ìœ¼ë¡œ</a>
            </div>
        </div>

        <!-- ìš°ì¸¡: ì´ì ê³„ì‚°ê¸° -->
        <div class="col-lg-4">
            <div class="p-4 border rounded shadow-sm sticky-top" style="top: 100px;">
                <h4 class="fw-bold mb-4">ğŸ“ˆ ì´ì ê³„ì‚°ê¸°</h4>
                <div class="mb-3">
                    <label class="form-label">ê¸ˆì•¡ (ì›)</label>
                    <input type="number" id="amount" class="form-control" placeholder="ê¸ˆì•¡ ì…ë ¥">
                </div>
                <div class="mb-3">
                    <label class="form-label">
                        {% if product_type == 'ëŒ€ì¶œ' %}
                            ìµœì € ê¸ˆë¦¬ (%) (ìë™)
                        {% else %}
                            ìµœê³  ìš°ëŒ€ê¸ˆë¦¬ (%) (ìë™)
                        {% endif %}
                    </label>
                    <input type="text" id="rate" class="form-control"
                        value="{% if product_type == 'ëŒ€ì¶œ' %}
                            {{ product['ê¸°ë³¸ê¸ˆë¦¬(%)'] }}
                        {% else %}
                            {{ product['ìµœê³ ìš°ëŒ€ê¸ˆë¦¬(%)'] }}
                        {% endif %}" readonly>
                </div>
                <div class="mb-3">
                    <label class="form-label">ê¸°ê°„ (ê°œì›”)</label>
                    <input type="number" id="period" class="form-control"
                        value="{% if product_type == 'ëŒ€ì¶œ' %}{{ product['ì €ì¶•ê¸°ê°„(ê°œì›”)'] if product['ì €ì¶•ê¸°ê°„(ê°œì›”)'] != 'ì •ë³´ì—†ìŒ' else 12 }}{% else %}{{ product['ì €ì¶•ê¸°ê°„(ê°œì›”)'] }}{% endif %}">
                </div>
                <button class="btn btn-success w-100" onclick="calculateInterest()">ê³„ì‚°í•˜ê¸°</button>
                <div class="mt-4">
                    <p><strong>ì˜ˆìƒ ì´ì:</strong> <span id="expected-interest">-</span> ì›</p>
                    <p><strong>{% if product_type == 'ëŒ€ì¶œ' %}ì´ ìƒí™˜ì•¡{% else %}ì´ ìˆ˜ë ¹ì•¡{% endif %}:</strong> <span id="total-amount">-</span> ì›</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function calculateInterest() {
        const amount = parseFloat(document.getElementById('amount').value);
        const rate = parseFloat(document.getElementById('rate').value);
        const period = parseFloat(document.getElementById('period').value);

        if (!amount || !rate || !period || isNaN(rate)) {
            alert('ê¸ˆì•¡, ê¸ˆë¦¬, ê¸°ê°„ì„ ì •í™•íˆ ì…ë ¥í•˜ì„¸ìš”.');
            return;
        }

        const interest = amount * (rate / 100) * (period / 12);
        const total = amount + interest;

        document.getElementById('expected-interest').innerText = Math.round(interest).toLocaleString();
        document.getElementById('total-amount').innerText = Math.round(total).toLocaleString();
    }
</script>
{% endblock %}
